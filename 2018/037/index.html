<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=author content="Mogeko"><meta name=description content="Mogeko 的个人博客"><meta name=keywords content="blog,KMS,Hugo,GNU/Linux,Linux,Ubuntu,Rusty Lake: Roots,Hollow Knight,空洞骑士"><link rel=prev href=https://mogeko.me/2018/036/><link rel=next href=https://mogeko.me/2018/038/><link rel=canonical href=https://mogeko.me/2018/037/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>Bash 命令提示符定制指南 | Mogeko`s Blog</title><meta name=title content="Bash 命令提示符定制指南 | Mogeko`s Blog"><link rel=stylesheet href=/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/mogeko.me"},"articleSection":"posts","name":"Bash 命令提示符定制指南","headline":"Bash 命令提示符定制指南","description":"\x26emsp;\x26emsp; -- 众所周知，Bash 是大多数 GNU\/Linux 的默认 shell。作为每个 Linuxer 每天都要接触到的东西，一个漂亮的 Bash 自然是会让人更加的心情舒畅。今天就来教教大家如","inLanguage":"zh-cn","author":"Mogeko","creator":"Mogeko","publisher":"Mogeko","accountablePerson":"Mogeko","copyrightHolder":"Mogeko","copyrightYear":"2018","datePublished":"2018-11-28 15:25:58 \x2b0800 \x2b0800","dateModified":"2018-11-28 15:25:58 \x2b0800 \x2b0800","url":"https:\/\/mogeko.me\/2018\/037\/","wordCount":"2648","keywords":["GNU\/Linux","Mogeko`s Blog"]}</script></head><body><div class=wrapper><nav class=navbar><progress class=content_progress max=0 value=0></progress><div class=container><div class="navbar-header header-back2home-logo"><span class=logo_mark>>$</span>
<a href=https://mogeko.me><span class=logo_text>cd /home/</span>
<span class=logo_cursor></span></a></div><div class=navbar-right><span class=menu><a class=menu-item href=/tools/>Tools</a>
<a class=menu-item href=/posts/>Blog</a>
<a class=menu-item href=/categories/>Categories</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about/>About</a>
<a class=menu-item href=/tools/></a><a class=menu-item href=/about/ title=Mogeko>Mogeko</a>
<span class=divide></span><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></span></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><progress class=content_progress max=0 value=0></progress><div class=container><div class=navbar><div class="navbar-header header-logo"><a href=https://mogeko.me>Mogeko`s Blog</a></div><div class=navbar-right><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dark-mode"></i></a></div><div class=menu-toggle><span></span><span></span><span></span></div></div></div><div class=menu id=mobile-menu><nav class=mb-md><a class=menu-item href=/tools/><h3>Tools</h3><div class=menu-active></div></a><a class=menu-item href=/posts/><h3>Blog</h3><div class=menu-active></div></a><a class=menu-item href=/categories/><h3>Categories</h3><div class=menu-active></div></a><a class=menu-item href=/tags/><h3>Tags</h3><div class=menu-active></div></a><a class=menu-item href=/about/><h3>About</h3><div class=menu-active></div></a><a class=menu-item href=/tools/><h3></h3><div class=menu-active></div></a><a class=menu-item href=/about/ title=Mogeko><h3>Mogeko</h3><div class=menu-active></div></a></nav></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">Bash 命令提示符定制指南</h1><div class=post-meta>Written by <a itemprop=name href=https://mogeko.me rel=author>Mogeko</a> with ♥
<span class=post-time>on <time datetime=2018-11-28 itemprop=datePublished>November 28, 2018</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category></span><span class=post-word-count>2648 words</span></div></header><div class=post-content><p>众所周知，Bash 是大多数 GNU/Linux 的默认 shell。作为每个 Linuxer 每天都要接触到的东西，一个漂亮的 Bash 自然是会让人更加的心情舒畅。今天就来教教大家如果自定义 Bash 的<strong>命令提示符</strong>。</p><br><p>bash 默认的<strong>命令提示符</strong>长这个模样：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext>mogeko@ubuntu:~$
</code></pre></div><p>其中的 <code>mogeko</code>：是我的用户名，<code>ubuntu</code>：是我的主机名，<code>~</code>：是当前目录。</p><p>非常的不美观，并且浪费空间 (用户名和主机名并不是我所关注的东西却占了很大的空间)。好在我们可以通过设置 <code>SP1</code>：来定制我们的<strong>命令提示符</strong>。</p><h2 id=关于-sp1-和-sp2>关于 SP1 和 SP2</h2><p>简单来说：</p><ul><li><p>SP1：bash 中命令输入的主提示符，如 <code>mogeko@ubuntu:~$</code></p></li><li><p>SP2：当命令特别长的时候，换行输入时的提示符，默认是 <code>></code></p></li></ul><br><p>可以在终端中使用 echo 命令查看系统默认参数：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext>mogeko@ubuntu:~$ echo $PS1
\u@\h:\W$
mogeko@ubuntu:~$ echo $PS2
&gt;
</code></pre></div><h2 id=定制命令提示符>定制命令提示符</h2><h3 id=举个栗子>举个栗子</h3><p>所谓定制命令提示符，实际上就是在 <code>~/.bashrc</code>：文件中改变变量 <code>PS1</code>：的值。</p><blockquote><p><strong>在开始之前，我强烈建议你预先备份 <code>~/.bashrc</code>：文件。</strong></p></blockquote><p>例如，我们不想关心<strong>主机名</strong>，只要一个<strong>用户名</strong>就够了；只需要在 <code>~/.bashrc</code>：文件的末尾加上以下命令：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>export PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;\u:\W</span>$<span style=color:#e6db74>&#34;</span>
</code></pre></div><p>使用命令 <code>:wq</code>：退出并保存</p><p>然后执行以下命令使刚才的修改生效：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext>source ~/.bashrc
</code></pre></div><p><img src=https://mogeko.github.io/blog-images/r/037/ex1.png alt=\u:\W$></p><p>通过上述例子我们可以看见，<strong>用户名</strong> 实际上就是参数 <code>\u</code>：的转义；同样的，<strong>主机名</strong> 对应的参数是 <code>\h</code>，<strong>当前目录路径</strong> 对应的参数是 <code>\W</code></p><p>我们想定制<strong>命令提示符</strong>，只需要将各参数按顺序排列组合就可以了。</p><h3 id=sp1-参数>SP1 参数</h3><p>如果想知道设置 <code>SP1</code> 可以使用哪些参数只需要执行一下 <code>man bash</code>，然后找到 <strong>PROMPTING</strong> 部分的说明就可以了：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext>PROMPTING
       When executing interactively, bash displays the primary prompt PS1 when it is ready to read a command, and the secondary prompt PS2 when it needs more input to complete a command. Bash allows these prompt strings to be customized by inserting a number of backslash-escaped special characters that are decoded as follows:
              \a an ASCII bell character (07)
              \d the date in &#34;Weekday Month Date&#34; format (e.g., &#34;Tue May 26&#34;)
              \D{format}
                     the format is passed to strftime(3) and the result is inserted into the prompt string; an empty format results in a locale-specific time representation.
                     The braces are required
              \e an ASCII escape character (033)
              \h the hostname up to the first ‘.’
              \H the hostname
              \j the number of jobs currently managed by the shell
              \l the basename of the shell’s terminal device name
              \n newline
              \r carriage return
              \s the name of the shell, the basename of $0 (the portion following the final slash)
              \t the current time in 24-hour HH:MM:SS format
              \T the current time in 12-hour HH:MM:SS format
              \@ the current time in 12-hour am/pm format
              \A the current time in 24-hour HH:MM format
              \u the username of the current user
              \v the version of bash (e.g., 2.00)
              \V the release of bash, version + patch level (e.g., 2.00.0)
              \w the current working directory, with $HOME abbreviated with a tilde (uses the value of the PROMPT_DIRTRIM variable)
              \W the basename of the current working directory, with $HOME abbreviated with a tilde
              \! the history number of this command
              \# the command number of this command
              \$ if the effective UID is 0, a #, otherwise a $
              \nnn the character corresponding to the octal number nnn
              \\ a backslash
              \[ begin a sequence of non-printing characters, which could be used to embed a terminal control sequence into the prompt
              \] end a sequence of non-printing characters
       The command number and the history number are usually different: the history number of a command is its position in the history list, which may include commands restored from the history file(see HISTORY below), while the command number is the position in the sequence of commands executed during the current shell session. After the string is decoded, it is expanded via parameter expansion, command substitution, arithmetic expansion, and quote removal, subject to the value of the promptvars shell option(see the description of the shopt command under SHELL BUILTIN COMMANDS below).
</code></pre></div><p>简单整理并翻译了一下：</p><ul><li><code>\a</code>：一个 ASCII 响铃字符 (07)</li><li><code>\d</code>：&ldquo;Weekday Month Date&rdquo; 格式的日期 (比如：&ldquo;Tue May 26&rdquo;)</li><li><code>\D{format}</code>：通过向 strftime 传值后回显自定义日期格式</li><li><code>\e</code>：ASCII 转义字符 (033)</li><li><code>\h</code>：主机名的第一部分，截取到第一个 &lsquo;.&rsquo;</li><li><code>\H</code>：主机的全称</li><li><code>\j</code>：在当前 shell 中管理的进程数</li><li><code>\l</code>：shell 的终端设备名称的基名</li><li><code>\n</code>：换行符</li><li><code>\r</code>：回车符</li><li><code>\s</code>：shell 的名称，当前脚本的名称，不包括路径</li><li><code>\t</code>：HH:MM:SS 格式的 24 小时制时间</li><li><code>\T</code>：HH:MM:SS 格式的 12 小时制时间</li><li><code>\@</code>：am/pm 格式的 12 小时制时间</li><li><code>\A</code>：HH:MM 格式的 12 小时制时间</li><li><code>\u</code>：当前用户的用户名</li><li><code>\v</code>：bash 的的版本 (如：-00)</li><li><code>\V</code>：bash 版本，包括补丁级别 (如：-00.0)</li><li><code>\w</code>：当前工作目录，包括路径</li><li><code>\W</code>：当前工作目录的基名，不包括路径</li><li><code>\!</code>：当前命令的历史记录编号</li><li><code>\#</code>：命令编号 (只要您键入内容，它就会在每次显示时累加)</li><li><code>\$</code>：如果您不是超级用户 (root)，则显示 &ldquo;$&rdquo;；如果您是超级用户，则显示 &ldquo;#&rdquo;</li><li><code>\nnn</code>：对应于八进制数 nnn 的字符</li><li><code>\\</code>：反斜杠</li><li><code>\[</code>：开始一系列非打印字符，可以将终端控制序列嵌入到提示符中</li><li><code>\]</code>：结束一系列非打印字符</li></ul><h2 id=为命令提示符着色>为命令提示符着色</h2><p>上面的参数可以改变命令提示符的内容。其实，命令提示符的颜色也是可以被修改的。</p><p>修改字符颜色需要用到以下两个标记：</p><ul><li><p><code>\e[F;Bm</code>：开始标记</p></li><li><p><code>\e[0m</code>：结束标记</p></li></ul><p>为字符设置颜色，只需要用两个标记将字符框起来就可以了：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext>\e[F;Bm需要设置颜色的部分\e[0m
</code></pre></div><p>其中 <code>F</code> 为字体颜色，编号 30~37；<code>B</code> 为背景色，编号 40~47。</p><table><thead><tr><th>示例</th><th>颜色</th><th>F</th><th>B</th></tr></thead><tbody><tr><td><span style=color:#000;background-color:#000>   </span></td><td>黑色</td><td>30</td><td>40</td></tr><tr><td><span style=color:red;background-color:red>   </span></td><td>红色</td><td>31</td><td>41</td></tr><tr><td><span style=color:#0f0;background-color:#0f0>   </span></td><td>绿色</td><td>32</td><td>42</td></tr><tr><td><span style=color:#ff0;background-color:#ff0>   </span></td><td>黄色</td><td>33</td><td>43</td></tr><tr><td><span style=color:#00f;background-color:#00f>   </span></td><td>蓝色</td><td>34</td><td>44</td></tr><tr><td><span style=color:#f0f;background-color:#f0f>   </span></td><td>粉紫色</td><td>35</td><td>45</td></tr><tr><td><span style=color:#0ff;background-color:#0ff>   </span></td><td>天蓝色</td><td>36</td><td>46</td></tr><tr><td><span style=color:#fff;background-color:#fff>   </span></td><td>白色</td><td>37</td><td>47</td></tr></tbody></table><p>例如 ：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>export PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;\[\e[32m\]\u\[\e[m\]\[\e[33m\]\\</span>$<span style=color:#e6db74>\[\e[m\] &#34;</span>
</code></pre></div><p>效果：</p><pre class="prettyprint linenums prettyprinted"><ol class=linenums><li class=L0><code class=language-shell><span class=str style=color:#0f0>mogeko</span><span class=str style=color:#ff0>$ </span></code></li></ol></pre><h2 id=返回错误值>返回错误值</h2><p>你也可以使用命令提示符来查看上一条命令执行的结果。</p><p>只需要在 <code>~/.bashrc</code> 中创建一个函数：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#66d9ef>function</span> nonzero_return<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
	RETVAL<span style=color:#f92672>=</span>$?
	<span style=color:#f92672>[</span> $RETVAL -ne <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;</span>$RETVAL<span style=color:#e6db74>&#34;</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>然后在调用 <code>SP1</code> 的时候中执行这个函数：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>export PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;\`nonzero_return\` &#34;</span>
</code></pre></div><h2 id=git-分支信息>Git 分支信息</h2><p>你甚至可以在命令提示符中查看 Git 的分支信息 (如果当前目录下有 Git 仓库的话)。</p><p>在 <code>~/.bashrc</code> 中创建函数：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>## get current branch in git repo</span>
<span style=color:#66d9ef>function</span> parse_git_branch<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
	BRANCH<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>git branch 2&gt; /dev/null | sed -e <span style=color:#e6db74>&#39;/^[^*]/d&#39;</span> -e <span style=color:#e6db74>&#39;s/* \(.*\)/\1/&#39;</span><span style=color:#e6db74>`</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>BRANCH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>]</span>
	<span style=color:#66d9ef>then</span>
		STAT<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>parse_git_dirty<span style=color:#e6db74>`</span>
		echo <span style=color:#e6db74>&#34;[</span><span style=color:#e6db74>${</span>BRANCH<span style=color:#e6db74>}${</span>STAT<span style=color:#e6db74>}</span><span style=color:#e6db74>]&#34;</span>
	<span style=color:#66d9ef>else</span>
		echo <span style=color:#e6db74>&#34;&#34;</span>
	<span style=color:#66d9ef>fi</span>
<span style=color:#f92672>}</span>

<span style=color:#75715e>## get current status of git repo</span>
<span style=color:#66d9ef>function</span> parse_git_dirty <span style=color:#f92672>{</span>
	status<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>git status 2&gt;&amp;<span style=color:#ae81ff>1</span> | tee<span style=color:#e6db74>`</span>
	dirty<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;modified:&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	untracked<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;Untracked files&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	ahead<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;Your branch is ahead of&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	newfile<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;new file:&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	renamed<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;renamed:&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	deleted<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;deleted:&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>renamed<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&gt;</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>ahead<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;*</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>newfile<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;+</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>untracked<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;?</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>deleted<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;x</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>dirty<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;!</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		echo <span style=color:#e6db74>&#34; </span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>else</span>
		echo <span style=color:#e6db74>&#34;&#34;</span>
	<span style=color:#66d9ef>fi</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>在调用 <code>SP1</code> 的时候中执行这个函数：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>export PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;\`parse_git_branch\` &#34;</span>
</code></pre></div><h2 id=我的命令提示符配置>我的命令提示符配置</h2><p>分享一下我个人使用的命令提示符配置 (复制粘贴到 <code>~/.bashrc</code> 的末尾)：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>## PS1&amp;PS2</span>
<span style=color:#75715e>## get current branch in git repo</span>
<span style=color:#66d9ef>function</span> parse_git_branch<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
	BRANCH<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>git branch 2&gt; /dev/null | sed -e <span style=color:#e6db74>&#39;/^[^*]/d&#39;</span> -e <span style=color:#e6db74>&#39;s/* \(.*\)/\1/&#39;</span><span style=color:#e6db74>`</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>BRANCH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>]</span>
	<span style=color:#66d9ef>then</span>
		STAT<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>parse_git_dirty<span style=color:#e6db74>`</span>
		echo <span style=color:#e6db74>&#34;[</span><span style=color:#e6db74>${</span>BRANCH<span style=color:#e6db74>}${</span>STAT<span style=color:#e6db74>}</span><span style=color:#e6db74>]&#34;</span>
	<span style=color:#66d9ef>else</span>
		echo <span style=color:#e6db74>&#34;&#34;</span>
	<span style=color:#66d9ef>fi</span>
<span style=color:#f92672>}</span>

<span style=color:#75715e>## get current status of git repo</span>
<span style=color:#66d9ef>function</span> parse_git_dirty <span style=color:#f92672>{</span>
	status<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>git status 2&gt;&amp;<span style=color:#ae81ff>1</span> | tee<span style=color:#e6db74>`</span>
	dirty<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;modified:&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	untracked<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;Untracked files&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	ahead<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;Your branch is ahead of&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	newfile<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;new file:&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	renamed<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;renamed:&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	deleted<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>echo -n <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>status<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> 2&gt; /dev/null | grep <span style=color:#e6db74>&#34;deleted:&#34;</span> &amp;&gt; /dev/null; echo <span style=color:#e6db74>&#34;</span>$?<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`</span>
	bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>renamed<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&gt;</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>ahead<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;*</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>newfile<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;+</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>untracked<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;?</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>deleted<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;x</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>dirty<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		bits<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;!</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>fi</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
		echo <span style=color:#e6db74>&#34; </span><span style=color:#e6db74>${</span>bits<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
	<span style=color:#66d9ef>else</span>
		echo <span style=color:#e6db74>&#34;&#34;</span>
	<span style=color:#66d9ef>fi</span>
<span style=color:#f92672>}</span>

<span style=color:#75715e>## return</span>
<span style=color:#66d9ef>function</span> get_return<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
    RETVAL<span style=color:#f92672>=</span>$?
    <span style=color:#75715e># Normal</span>
    <span style=color:#f92672>[</span> $RETVAL -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> echo -e <span style=color:#e6db74>&#34;\033[32m▶ \033[0m&#34;</span>
    <span style=color:#75715e># Ctrl + C</span>
    <span style=color:#f92672>[</span> $RETVAL -eq <span style=color:#ae81ff>130</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> echo -e <span style=color:#e6db74>&#34;\033[32m▶ \033[0m&#34;</span>
    <span style=color:#75715e># Ctrl + Z</span>
    <span style=color:#f92672>[</span> $RETVAL -eq <span style=color:#ae81ff>148</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> echo -e <span style=color:#e6db74>&#34;\033[32m▶ \033[0m&#34;</span>

    <span style=color:#75715e># Error</span>
    <span style=color:#f92672>[</span> $RETVAL -ne <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> $RETVAL -ne <span style=color:#ae81ff>130</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> $RETVAL -ne <span style=color:#ae81ff>148</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> echo -e <span style=color:#e6db74>&#34;\033[31m✗ \033[0m&#34;</span>
<span style=color:#f92672>}</span>

export PS1<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;\`get_return\`\[\e[36m\][\W]\[\e[m\]\[\e[35m\]\`parse_git_branch\`\[\e[m\]\[\e[33m\]\\</span>$<span style=color:#e6db74>\[\e[m\] &#34;</span>
export PS2<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;\[\e[32m\]&gt;\[\e[m\] &#34;</span>
</code></pre></div><p>具有以下特点：</p><ul><li>第一位的是上一条命令的返回值 (正常情况下为：<span style=color:#0f0>▶</span> 运行出错为：<span style=color:red>✗</span>)</li><li>第二位的是当前的目录</li><li>第三位的是当前目录的 Git 分支信息 (当前目录下没有 Git 仓库时自动隐藏)</li><li>换行输入时的提示符：<span style=color:#0f0>></span></li></ul><br><p>效果：</p><pre class="prettyprint linenums prettyprinted" style=overflow:auto><ol class=linenums><li class=L0><code class=language-shell><span class=pun style=color:#0f0>▶</span><span class=pln> </span><span class=pun style=color:#0ff>[~]</span><span class=pln style=color:#0ff><span class=pun style=color:#ff0>$</span><span class=pln> cd </span><span class=pun>~/Project/blog</span></code></li><li class=L1><code class=language-shell><span class=pun style=color:#0f0>▶</span><span class=pln> </span><span class=pun style=color:#0ff>[blog]</span><span class=pun style=color:#f0f>[master]</span><span class=pln style=color:#0ff><span class=pun style=color:#ff0>$</span><span class=pln> gi</span></code></li><li class=L2><code class=language-shell><span class=pln>gi</span><span class=pun>：未找到命令</span></code></li><li class=L3><code class=language-shell><span class=pun style=color:red>✗</span><span class=pln> </span><span class=pun style=color:#0ff>[blog]</span><span class=pun style=color:#f0f>[master]</span><span class=pln style=color:#0ff><span class=pun style=color:#ff0>$</span><span class=pln> \</span></code></li><li class=L4><code class=language-shell><span class=pun style=color:#0f0>&gt;</span><span class=pln> \</span></code></li><li class=L5><code class=language-shell><span class=pun style=color:#0f0>&gt;</span><span class=pln> touch temp</span><span class=pun>.</span><span class=pln>txt</span></code></li><li class=L6><code class=language-shell><span class=pun style=color:#0f0>▶</span><span class=pln> </span><span class=pun style=color:#0ff>[blog]</span><span class=pun style=color:#f0f>[master]</span><span class=pln style=color:#0ff><span class=pun style=color:#ff0>$</span><span class=pln> </span></code></li></ol></pre><br><center>·End·</center></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>Mogeko</span></p><p class=copyright-item><span>Link:</span>
<a href=https://mogeko.me/2018/037/>https://mogeko.me/2018/037/</span></p><p class="copyright-item lincese">本文采用<a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/ target=_blank>知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://mogeko.me/tags/gnu/linux/>#GNU/Linux</a></span></section><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://mogeko.me>home</a></span></section></div><div class=post-nav><a href=https://mogeko.me/2018/036/ class=prev rel=prev title="如何使用 ASF 挂卡"><i class="iconfont icon-left"></i>&nbsp;如何使用 ASF 挂卡</a>
<a href=https://mogeko.me/2018/038/ class=next rel=next title=对，这他妈就是生活！>对，这他妈就是生活！&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><div id=gitalk-container></div><link rel=stylesheet href=https://cdn.bootcss.com/gitalk/1.5.2/gitalk.css><script src=https://cdn.bootcss.com/gitalk/1.5.2/gitalk.min.js></script><script>const gitalk=new Gitalk({clientID:'936cecdd2ab935870ca5',clientSecret:'39cfc7a3cb9a974b6609f3fdaa637e2917e3e40a',repo:'blog-commits',owner:'Mogeko',admin:['Mogeko'],id:location.pathname,distractionFreeMode:false});(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('gitalk-container').innerHTML='Gitalk comments not available by default when the website is previewed locally.';return;}
gitalk.render('gitalk-container');})();</script></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2017 - 2020</span>
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://mogeko.me>Mogeko</a> |</span>
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/Mogeko/Mogege target=_blank rel="external nofollow">Mogege</a></span></div></footer><script src=/js/vendor_main.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js></script><script>pangu.spacingPage();</script></div></body></html>